<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>WinCC Open Architecture - Project manager</title>
    <link rel="stylesheet" href="css/style.css">
    <script src="js/app.js" defer></script>
</head>
<body>
    <div class="header">
        <!-- WinCC OA Logo SVG -->
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 219.9 219.9">
            <style>
                .cls-1 { fill: #01656e; }
                .cls-2 { fill: #ffd732; }
                .cls-3 { fill: #00557c; }
                .cls-4 { fill: #1fb9d8; }
            </style>
            <g id="winccoa">
                <rect class="cls-4" width="50.1" height="50.1"/>
                <rect class="cls-3" x="56.6" width="50.1" height="50.1"/>
                <rect class="cls-1" x="113.2" width="50.1" height="50.1"/>
                <rect class="cls-4" x="169.8" width="50.1" height="50.1"/>
                <rect class="cls-3" y="56.6" width="50.1" height="50.1"/>
                <rect class="cls-2" x="56.6" y="56.6" width="50.1" height="50.1"/>
                <rect class="cls-4" x="113.2" y="56.6" width="50.1" height="50.1"/>
                <rect class="cls-2" x="169.8" y="56.6" width="50.1" height="50.1"/>
                <rect class="cls-2" y="113.2" width="50.1" height="50.1"/>
                <rect class="cls-1" x="56.6" y="113.2" width="50.1" height="50.1"/>
                <rect class="cls-3" x="113.2" y="113.2" width="50.1" height="50.1"/>
                <rect class="cls-1" x="169.8" y="113.2" width="50.1" height="50.1"/>
                <rect class="cls-3" y="169.8" width="50.1" height="50.1"/>
                <rect class="cls-2" x="56.6" y="169.8" width="50.1" height="50.1"/>
                <rect class="cls-1" x="113.2" y="169.8" width="50.1" height="50.1"/>
                <rect class="cls-4" x="169.8" y="169.8" width="50.1" height="50.1"/>
            </g>
        </svg>
        <h1>WinCC Open Architecture â€“ Project manager</h1>
    </div>

    <div>
        <!-- Tab Navigation -->
        <ul class="tab-menu">
            <li class="tab-link active" onclick="openTab(event, 'Download')">Download</li>
            <li class="tab-link" onclick="openTab(event, 'Status')">Console</li>
            <li class="tab-link" onclick="openTab(event, 'Logs')">Log Viewer</li>
        </ul>

        <!-- Download Tab -->
        <div class="tab-content active" id="Download">
            <div class="form-wrapper">
                <div class="form-box">
                    <h2>Download Your Project</h2>
                    <form id="downloadForm" onsubmit="handleDownload(event)" enctype="multipart/form-data">
                        <label for="dateiupload">Select ZIP file:</label>
                        <input type="file" name="dateiupload" accept=".zip" required>

                        <label>
                            <input type="checkbox" name="restartProject" id="restartProject" value="true" onchange="toggleNotice()">
                            Restart project after download
                        </label>

                        <div id="restartNotice" class="warning-notice">
                            <strong>Warning:</strong> This will restart <u>ALL managers</u> after project downloaded to WinCC OA server(s). This may cause loss of production.
                        </div>

                        <input type="submit" value="Download">
                    </form>

                    <!-- Confirmation Modal -->
                    <div id="confirmationModal" class="modal-overlay">
                        <div class="modal-content">
                            <h3>Restart of project</h3>
                            <p>You have requested to restart the project.<br><strong>All managers will be restarted after download.</strong><br>Do you wish to continue?</p>
                            <button class="primary" onclick="confirmDownload(true)">Yes, continue</button>
                            <button onclick="confirmDownload(false)">Cancel</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Console Tab -->
        <div class="tab-content" id="Status">
            <div class="form-wrapper">
                <div class="form-box" style="max-width: 95% !important;">
                    <!-- Console Toolbar -->
                    <div class="console-toolbar">
                        <div class="toolbar-left">
                            <input type="button" onclick="refreshStatus()" value="Refresh" class="btn-toolbar">
                            <input type="button" onclick="restartProject()" value="Restart" class="btn-toolbar btn-danger">
                        </div>
                        <div class="toolbar-right">
                            <div class="auto-refresh-controls">
                                <label class="auto-refresh-label">
                                    <input type="checkbox" id="autoRefreshCheckbox" onchange="toggleAutoRefresh()">
                                    <span id="autoRefreshStatus" class="status-indicator" title="Auto-refresh disabled"></span>
                                    Auto-refresh
                                </label>
                                <select id="refreshIntervalSelect" onchange="changeRefreshInterval()" disabled>
                                    <option value="2000">2s</option>
                                    <option value="5000" selected>5s</option>
                                    <option value="10000">10s</option>
                                    <option value="30000">30s</option>
                                    <option value="60000">1min</option>
                                </select>
                            </div>
                            <div class="last-refresh">
                                Last update: <span id="lastRefreshTime">--:--:--</span>
                            </div>
                        </div>
                    </div>

                    <div id="instanceTabsContainer"></div>
                    <div id="instanceContentContainer"></div>
                </div>
            </div>
        </div>

        <!-- Log Viewer Tab -->
        <div class="tab-content" id="Logs">
            <div class="form-wrapper">
                <div class="form-box">
                    <h2>Log Viewer</h2>
                    <p>Coming soon...</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Server Availability Modal -->
    <div id="serverModal" style="display:none;">
        <div>
            <p>Please wait while we try to reach the server...</p>
        </div>
    </div>
</body>
</html>
